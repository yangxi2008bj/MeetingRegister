<html style="overflow-x: hidden; overflow-y: auto;" class="">
<head>
<script type="text/javascript">
	var globle_cellphone = false;
</script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon"
	href="/resources/images/apple-touch-icon-iphone.png">
<link rel="apple-touch-icon" sizes="72x72"
	href="/resources/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="76x76"
	href="/resources/images/apple-touch-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="120x120"
	href="/resources/images/apple-touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="114x114"
	href="/resources/images/apple-touch-icon-iphone4.png">
<link rel="apple-touch-icon-precomposed"
	href="/resources/images/apple-touch-icon.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72"
	href="/resources/images/apple-touch-icon.png">
<link rel="apple-touch-icon-precomposed" sizes="76x76"
	href="/resources/images/apple-touch-icon.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120"
	href="/resources/images/apple-touch-icon.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114"
	href="/resources/images/apple-touch-icon.png">

<link
	href="/resources/bootstrap/docs/assets/css/bootstrap-responsive.css"
	rel="stylesheet">
<title>身份验证</title>
<!--  - 校友通  -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta http-equiv="Cache-Control" content="no-store">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta http-equiv="X-UA-Compatible" content="IE=7,IE=9,IE=10">
<script src="/resources/jquery/jquery-1.9.1.min.js"
	type="text/javascript"></script>
<script src="/resources/jquery/jquery-migrate-1.1.1.min.js"
	type="text/javascript"></script>
<link href="/resources/jquery-validation/1.11.1/jquery.validate.min.css"
	type="text/css" rel="stylesheet">
<script src="/resources/jquery-validation/1.11.1/jquery.validate.min.js"
	type="text/javascript"></script>
<script
	src="/resources/jquery-validation/1.11.1/jquery.validate.method.min.js"
	type="text/javascript"></script>
<link href="/resources/bootstrap/2.3.1/css_cerulean/bootstrap.min.css"
	type="text/css" rel="stylesheet">
<script src="/resources/bootstrap/2.3.1/js/bootstrap.min.js"
	type="text/javascript"></script>
<script src="/resources/My97DatePicker/WdatePicker.js"
	type="text/javascript"></script>
<link href="/resources/My97DatePicker/skin/WdatePicker.css"
	rel="stylesheet" type="text/css">
<script src="/resources/common/mustache.min.js" type="text/javascript"></script>
<script src="/resources/list/list.min.js" type="text/javascript"></script>
<script src="/resources/select2/select2.js" type="text/javascript"></script>
<script src="/resources/select2/select2_locale_zh-CN.js"
	type="text/javascript"></script>
<link href="/resources/select2/select2.css" type="text/css"
	rel="stylesheet">
<link href="/resources/x-editable/css/bootstrap-editable.css"
	type="text/css" rel="stylesheet">
<script src="/resources/x-editable/js/bootstrap-editable.js"
	type="text/javascript"></script>
<link href="/resources/fancyBox/source/jquery.fancybox.css"
	type="text/css" rel="stylesheet">
<script src="/resources/fancyBox/source/jquery.fancybox.js"
	type="text/javascript"></script>
<link href="/resources/common/hyqd.min.css" type="text/css"
	rel="stylesheet">
<script src="/resources/common/hyqd.min.js" type="text/javascript"></script>
<link href="/resources/common/custom.css" type="text/css"
	rel="stylesheet">


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="decorator" content="default">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script src="/resources/common/login/js/login.js" type="text/javascript"></script>
<link href="/resources/common/regit.css" rel="stylesheet"
	type="text/css">
<link href="/resources/jquery-jbox/2.3/Skins/Bootstrap/jbox.css"
	rel="stylesheet">
<script src="/resources/jquery-jbox/2.3/jquery.jBox-2.3.min.js"
	type="text/javascript"></script>
<script src="/resources/jquery-jbox/2.3/i18n/jquery.jBox-zh-CN.min.js"
	type="text/javascript"></script>

<style type="text/css">
.login_option {
	height: 40px;
	width: 100% -1px;
	height: 43px;
}

li {
	list-style-type: none;
}

.login_option li {
	float: left;
	width: 50%;
	text-align: center;
	line-height: 40px;
	font-family: "微软雅黑";
	font-size: 14px;
	color: #239aee;
	cursor: pointer;
}

.login_option .active {
	float: left;
	width: 100%;
	text-align: center;
	line-height: 40px;
	font-family: "微软雅黑";
	font-size: 14px;
	border-bottom-width: 3px;
	border-bottom-style: solid;
	border-bottom-color: #239aee;
	color: #666;
	!
	important;
}

.login_surface .cation {
	display: block;
}

.login_surface li {
	display: none;
	width: 100%;
}
</style>
<script type="text/javascript">
	String.prototype.trim = function() {
		return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
	}

	$(document)
			.ready(
					function() {
						$("#form-signin")
								.validate(
										{
											submitHandler : function(form) {
												if ($("#user_name").val() == "") {
													$.jBox.tip("请填写姓名");
													return;
												} else if ($("#userTel").val() == "") {
													$.jBox.tip("请填写手机号");
													return;
												} else if ($("#code").val() == "") {
													$.jBox.tip("请输入验证码");
													return;
												} else {
													var rad1 = $("#random")
															.val();
													var rad2 = $("#random2")
															.val();
													if (rad1.length == 0
															|| rad2.length == 0) {
														basictoNext();
														return false;
													}

													$
															.ajax({
																type : "POST",
																url : "/sys/user_checkCodeToRegister",
																data : {
																	'userTel' : $
																			.trim($(
																					"#userTel")
																					.val()),
																	'code' : $
																			.trim($(
																					"#code")
																					.val()),
																	'random' : $
																			.trim($(
																					"#random")
																					.val()),
																	'random2' : $
																			.trim($(
																					"#random2")
																					.val())
																},
																success : function(
																		result) {
																	if (result == 'false') {
																		$(
																				"#loginError")
																				.html(
																						"<font color='red'>验证码错误.</font>");
																		return;
																	} else {
																		form
																				.submit();
																	}
																}
															});
												}
											}
										});

						$("#form-general")
								.validate(
										{
											submitHandler : function(form) {
												if ($("#user_name2").val() == "") {
													$.jBox.tip("请填写姓名");
													return;
												} else if ($("#user_loginName2")
														.val() == "") {
													$.jBox.tip("请填写账号");
													return;
												} else if (!/^[a-zA-Z0-9.\-_@]+$/
														.test($(
																"#user_loginName2")
																.val())) {
													$.jBox
															.tip("账号只能输入数字0~9字母a~z(A~Z)或者符号. - _ @");
													return;
												} else if ($("#pwd").val() == "") {
													$.jBox.tip("请输入密码");
													return;
												} else {
													$
															.ajax({
																type : "POST",
																url : "/sys/user_checkLoginName",
																data : {
																	'loginName' : $
																			.trim($(
																					"#user_loginName2")
																					.val()),
																	'password' : $
																			.trim($(
																					"#pwd")
																					.val())
																},
																success : function(
																		result) {
																	if (result == 'true') {
																		$(
																				"#loginError2")
																				.html(
																						"<font color='red'>帐号已存在，请使用其它帐号注册.</font>");
																		return;
																	} else {
																		form
																				.submit();
																	}
																}
															});
												}
											}
										});

					});
</script>

<script type="text/javascript">
	//效验手机格式
	function sendCodeTotel(tel) {
		var value = tel;
		if (value.length == 11
				&& /^(((1[3,4,5,7,8][0-9]{1}))+\d{8})$/.test(value)) {
			return true;
		} else {
			$.jBox.tip("请输入正确的手机");
			return false;
		}
	}
	//校验账号
	function sendCodeTonum(num) {
		if (num == '') {
			return;
		}

		var turenum = /^[a-zA-Z0-9.\-_@]+$/.test(num);
		if (turenum) {
			return true
		} else {
			$.jBox.tip('账号只能输入数字0~9字母a~z(A~Z)或者符号. - _ @');
			return false;
		}
	}
	//发送验证码
	function sendTelCode(tel) {
		$.ajax({
			url : "/sys/user_sendMessage",
			type : "POST",
			cache : false,
			dataType : "json",
			data : {
				"cellphone" : function() {
					return tel;
				}
			},
			success : function(data) {
				if (data.success) {
					$("#sendButton").val("已发送");
					$("#random").val(data.random);
					$("#random2").val(data.random2);
					$("#sendButton").attr("disabled", true);//设置按钮不可用
					settimeout();
					$.jBox.tip("已发送...");
				}
			},
			error : function() {
				alert("网络状态不稳定,验证码发送失败,请重新点击发送");
			}
		});
	}

	var time = 45;

	function settimeout() {
		var stop = null;
		stop = setInterval(function() {
			if (time > 0) {
				$("#sendButton").val(time + "秒");
				time--;
			} else {
				$("#sendButton").val("重发");
				$("#sendButton").attr("disabled", false);
				clearInterval(stop);
				time = 45;
			}
		}, 1000);
	}
	//效验用户名和手机

	function basictoNext() {

		if (time > 0 && time < 45) {
			$.JBox.tip("已发送，请稍等...");
			return false;
		}
		//验证手机号是否正确
		var res = sendCodeTotel($("#userTel").val());
		if (!res) {
			return res;
		}
		if ($("#user_name").val().trim() != ""
				&& $("#userTel").val().trim() != "") {
			$("#sendButton").attr("disabled", true);
			$.ajax({
				url : "/sys/user_checkTelName1",
				type : "POST",
				cache : false,
				data : {
					"username" : $("#user_name").val().trim(),
					"cellphone" : $("#userTel").val()
				},
				dataType : "json",
				success : function(data) {
					if (data.success != 'true') {
						$("#sendButton").attr("disabled", false);
						$.jBox.tip(data.success);
						return false;
					}
					sendTelCode($("#userTel").val());
				},
				error : function() {
					$("#sendButton").attr("disabled", false);
					return false;
				}
			});

		}

	}
</script>


<style type="text/css">
.fancybox-margin {
	margin-right: 0px;
}
</style>
</head>
<body>
	<div class="half-common">
		<div id="top">注册登录账号</div>
		<script type="text/javascript">
			top.$.jBox.closeTip();
		</script>
		<input type="hidden" id="random" name="user.random"> <input
			type="hidden" id="random2" name="user.random2"> <input
			type="hidden" id="hasShow" name="user.hasShow" value="true">

		<div class="login_option"
			style="border-left-width: 1px; border-left-style: solid; border-left-color: #CCC; border-right-width: 1px; border-right-style: solid; border-right-color: #CCC;">
			<li class="active">手机验证码注册</li>
		</div>
		<div class="login_surface">
			<li id="basic_div" class="cation">
				<form class="form-signin" id="form-signin" method="post"
					action="/sys/user_register1" novalidate="novalidate">
					<input type="hidden" name="mId" value="60"> <input
						type="hidden" name="signUpType" value="1">
					<table>
						<tbody>
							<tr>
								<td width="80px">姓名</td>
								<td><input name="user.userName" id="user_name"
									placeholder="填写参会人员的姓名" maxlength="20" value=""
									style="width: 80%; border: none; margin: 0px; outline: none;">
								</td>
							</tr>
							<tr>
								<td>手机</td>
								<td><input name="user.userTel" maxlength="11"
									placeholder="填写参会人员的手机" id="userTel" value=""
									style="width: 80%; border: none; outline: none; margin: 0px;"
									onblur="sendCodeTotel(this.value)"></td>
							</tr>
							<tr>
								<td>验证码</td>
								<td><input name="code" maxlength="11" class="span6"
									value="" id="code" placeholder="验证码"
									style="width: 50%; border: none; margin: 0px;"> <input
									type="button" name="sendMessage" value="发送验证码" id="sendButton"
									class="btn" onclick="basictoNext();"
									style="border: 1px solid #CCC; background-color: #FFF; margin-top: 8px; margin-left: 10px; padding: 5px, 10px, 5px; width: 35%; height: 30px; float: right'">
								</td>
							</tr>
						</tbody>
					</table>
					<p class="p-instruction"></p>
					<div style="height: 5px;"></div>
					<label id="loginError" style="margin-left: 20px; margin-top: 10px"></label>
					<div id="btn">
						<button class="btn btn-large btn-primary"
							style="width: 330px; margin-top: 20px;" type="submit">验证</button>
					</div>
				</form>
			</li>


			<form class="form-general" id="form-general" method="post"
				action="/sys/user_register2" novalidate="novalidate">
				<input type="hidden" name="mId" value="60"> <input
					type="hidden" name="signUpType" value="1">
				<li id="basic_div">
					<table>
						<tbody>
							<tr>
								<td width="80px">姓名</td>
								<td><input name="user.userName" id="user_name2"
									placeholder="填写参会人员的姓名" maxlength="20" value=""
									style="width: 80%; border: none; margin: 0px; outline: none;">
								</td>
							</tr>
							<tr>
								<td width="80px">账号</td>
								<td><input name="user.userLoginName" id="user_loginName2"
									placeholder="设置登录账号" maxlength="20" value=""
									style="width: 80%; border: none; margin: 0px; outline: none;"
									onblur="sendCodeTonum(this.value)"
									data-form-un="1517813666877.7712"></td>
							</tr>
							<tr>
								<td>密码</td>
								<td><input type="password" id="pwd"
									name="user.userPassword" maxlength="11" placeholder="设置初始登录密码"
									value=""
									style="width: 80%; border: none; outline: none; margin: 0px;"
									data-form-pw="1517813666877.7712"></td>
							</tr>
						</tbody>
					</table>
					<p class="p-instruction">
						说明：<br> 参会代表报名流程：注册登录账号-&gt;填写个人信息-&gt;填写参会信息<br>
					</p>
					<div style="height: 5px;"></div> <label id="loginError2"
					style="margin-left: 20px; margin-top: 10px"></label>
					<div id="btn">
						<button class="btn btn-large btn-primary"
							style="width: 330px; margin-top: 20px; pointer-events: auto;"
							type="submit" data-form-sbm="1517813666877.7712">下一步</button>
					</div>
				</li>
			</form>
		</div>

	</div>



	<script type="text/javascript">
		$(function() {
			var system = {
				iphone : false,
				ipod : false,
				ipad : false,
				ios : false,
				android : false,
				nokiaN : false,
				winMobile : false
			};
			//在此检测平台，设备，呈现引擎
			var ua = navigator.userAgent;
			system.iphone = ua.indexOf("iPhone") > -1;
			system.ipod = ua.indexOf("iPod") > -1;
			system.ipad = ua.indexOf("iPad") > -1;
			//检测 iOS 版本
			if (system.mac && ua.indexOf("Mobile") > -1) {
				if (/CPU (?:iPhone )?OS (\d+_\d+)/.test(ua)) {
					system.ios = parseFloat(RegExp.$1.replace("_", "."));
				} else {
					system.ios = 2; //不能真正检测出来，所以只能猜测
				}
			}
			//检测 Android 版本
			if (/Android (\d+\.\d+)/.test(ua)) {
				system.android = parseFloat(RegExp.$1);
			}
			//nokia
			system.nokiaN = ua.indexOf("NokiaN") > -1;

			if (system.android || system.iphone || system.ipod || system.ipad
					|| system.ios || system.nokiaN || system.winMobile) {
				//是移动端
				$("#header").hide();//css("display","none");
				$("#menuFrame").hide();//css("display","none");
				$("#themeSwitch").hide();//css("display","none");
				$("#_register_").show();
				$("div._mobile_device").hide();

			}

		});
	</script>

</body>
</html>